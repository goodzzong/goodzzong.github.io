---
layout: post
title: 실행 컨텍스트
name : goodzzong
date: 2018-09-05
categories: Javascript

tags: [Javascript]
comments: true
---

## 정의

자바스크립트에서의 코드는 크게 세가지로 분류가 된다. global 코드, function 코드, eval 코드. 그리고 이 모든 코드는 실행컨택스트에 들어와 실행이 된다. 즉 자바스크립트에서 실행되는 모든 것들을 관리하는 부분이 바로 실행컨택스트부분이다.

글로벌 컨텍스트는 오직 하나만 존재한다.

function, eval 컨텍스트는 여러개가 존재 가능하다.

하나의 함수는 무한대의 컨텍스트를 생선한다.
```js
function foo(bar){}
foo(10)
foo(20)
foo(30)

```

이 경우 동일한 함수를 다른인자로 호출했지만 서로 다른 컨텍스트 세개가 실행된다.

## 동작 방식

실행컨텍스트는 실행컨텍스트 스택 영역에 저장된다.
나중에 들어온 컨텍스트가 스택 최상단에 위치하고 위로 쌓이게 된다. 
현재 실행이 되고 있는 컨텍스트를 callee 실행컨텍스트내에서 다른 컨텍스트를 실행 시키기위해 필요한것이 caller이다.

- 예시
  1. caller가 어떤 컨텍스트를 실행.
  2. 기존 caller가 동작시키고 있던 실행의 흐름이 새롭게 등족하는 컨텍스트로 변경(callee로 변경)
  3. 변경 되었기 때문에 해당 callee가 최상단에 위치 하고 Active Context 라는 이름을 가진다.
  4. Active Context의 실행이 끝나면 다시 caller가 다른 context로 실행을 변경하고, 이는 끝날때까지 반복.
  5. 동작이 끝나면 처음 실행된 callee가 리턴하거나 예외처리를 하고 종료한다.


- 프로그램 실행의 예시
  1. 프로그램 실행
  2. 실행컨텍스트의 제일 아래에 쌓이게 되는 글로벌 실행컨텍스트가 쌓인다.(최초의 컨텍스트)
  3. 글로벌 코드들이 초기화 작업 진행하며 필요한 객체나 함수들을 생성. 이러면서 글로벌 컨텍스트 위로 쌓이게 된다.
  4. 초기화가 끝나면 사용자의 클릭이나 글로벌하게 발생하는 함수 실행같은 이벤트가 발생하기를 기다리게 된다.
  5. 그후 이벤트 발생시에 해당 실행컨텍스트가 동작하게 된다.  

<br />
## 실행 컨텍스트의 구조

실행 컨텍스트는 변수객체(Variable object), 스코프체인(scope chain), thisValue라는 정보를 담고 있다.

### 변수객체
실행컨텍스트와 연괸된 데이터의 정보를 담고 있는 객체이다. 대부분의 변수나 함수를 선언하면 이곳에 저장된다.
쉽게 표현하면 var로 변수를 선언하면 이곳에 프로퍼티로 저장된다.
변수나 함수를 생성한다는 의미는 변수객체에 프포퍼티를 추가한다는 의미로 봐도 된다.

**젼역컨텍스트의 변수객체와 함수컨텍스트의 변수객체의 차이.** 
 - 앞서 설명 한것과 같이 초기화 작업이 시작되고 글로벌 컨텍스트 위로 쌓이게 된다. 프로그램 어떤 곳에서도 접근이 가능하다.
전역컨텍스트상에서는 this나 window 같은 프로퍼티로도 접근이 가능하다.
 - 함수 변수객체에서는 직접적으로 변수객체에 접근이 불가능하다. 그래서 그 변수객체의 내용을 그대로 가지고 있는 활성화 객체(Activation object)라는 것이 존재하여 변수를 사용하게 된다. 일단 함수가 caller에 의해 실행이 되면 활성화 객체가 생성이 된다. 이는 함수내에서 사용하는 파라미터 정의와 argument라는 특별한 객체도 생성된다. 그리고 이렇게 생성된 활성화 객체를 우리는 함수의 변수객체로 사용하게 된다.

 출처: http://yubylab.tistory.com/entry/자바스크립트-변수로-자바스크립트-이해하기 [Yuby's Lab.]